<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jje.vbp.taobao.persistence.TaobaoBindingMapper">

	<resultMap id="taobaoBindingResult" type="taobaoBindingDomain">
		<id property="id" column="ID" />
		<result property="taobaoId" column="TAOBAO_ID" />
		<result property="taobaoLevel" column="TAOBAO_LEVEL" />
		<result property="memberId" column="MEMBER_ID" />
		<result property="status" column="STATUS" />
		<result property="bindMode" column="BIND_MODE" />
		<result property="createDate" column="CREATE_DATE" />
		<result property="updateDate" column="UPDATE_DATE" />
	</resultMap>

<!-- 	<select id="query" resultMap="taobaoBindingResult">
		SELECT
		*
		FROM
		T_VBP_MEMBER_TAOBAO_BINDING
		WHERE 
		taobao_id =
		#{taobaoId,jdbcType=VARCHAR}
		<if test="memberId != null and  memberId != '' ">
	    	or member_Id = #{memberId, jdbcType=VARCHAR}
		</if>
	</select> -->
	
 	<select id="query" resultMap="taobaoBindingResult">
		SELECT
		*
		FROM
		T_VBP_MEMBER_TAOBAO_BINDING
		WHERE 
		taobao_id =
		#{taobaoId,jdbcType=VARCHAR}
	</select> 

	<select id="queryTaobaoID" resultMap="taobaoBindingResult">
		SELECT
		*
		FROM
		T_VBP_MEMBER_TAOBAO_BINDING
		WHERE 1=1
		and member_id =
		#{memberID,jdbcType=VARCHAR}
	</select>
	
	<insert id="insert" parameterType="taobaoBindingDomain">
		<selectKey keyProperty="id" resultType="long" order="BEFORE">
			SELECT
			S_VBP_MEMBER_TAOBAO_BINDING.NEXTVAL FROM DUAL
		</selectKey>
		insert into T_VBP_MEMBER_TAOBAO_BINDING
		(
		ID,
		MEMBER_ID,
		TAOBAO_ID,
		TAOBAO_LEVEL,
		STATUS,
		BIND_MODE
		)
		values
		(
		#{id},
		#{memberId,jdbcType=VARCHAR},
		#{taobaoId,jdbcType=VARCHAR},
	    #{taobaoLevel,jdbcType=VARCHAR},
		#{status,jdbcType=VARCHAR},
		#{bindMode,jdbcType=VARCHAR}
		)
	</insert>

	<update id="updateStatus">
		update T_VBP_MEMBER_TAOBAO_BINDING
		<set>
			<if test="status != null">
				status = #{status,jdbcType=VARCHAR},
			</if>
			UPDATE_DATE=sysdate,
		</set>
		where taobao_id = #{taobaoId,jdbcType=VARCHAR}
	</update>
</mapper>